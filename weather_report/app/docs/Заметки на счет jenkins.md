# Полезные команды

* `hostnamectl` - информация о системе
* `useradd <username>` - Создать пользователя
* `cat /etc/passwd` - список пользователей в системе
* `adduser <username> sudo` - добавить пользователя в группу sudo
* `usermod <username> -s /bin/bash` - изменить командную оболочку пользователя на bash 
* `mkhomedir_helper <username>` - создать домашний каталог пользователю
* `ls -lT` - Список файлов отсортированный по времени редактирования
* `ssh  -L 8078:127.0.0.1:8080 ohaggard@178.170.197.115 -p 2200` - подключится по ssh с пробросом порта

## Ссылки
1) [Шпаргалки по работе с пользователями linux](https://www.dmosk.ru/miniinstruktions.php?mini=linux-users)
2) [О группах пользователей](https://losst.pro/gruppy-polzovatelej-linux)
3) [Проброс портов через ssh](https://habr.com/ru/companies/flant/articles/691388/)

## Понимание файла /etc/passwd
```bash
mark:x:1001:1001:mark,,,:/home/mark:/bin/bash
[--] - [--] [--] [-----] [--------] [--------]
|    |   |    |     |         |        |
|    |   |    |     |         |        +-> 7. Login shell
|    |   |    |     |         +----------> 6. Home directory
|    |   |    |     +--------------------> 5. GECOS
|    |   |    +--------------------------> 4. GID
|    |   +-------------------------------> 3. UID
|    +-----------------------------------> 2. Password
+----------------------------------------> 1. Username
```

1. Username. Строка, которую вы вводите при входе в систему. Каждое имя пользователя должно быть уникальной строкой на компьютере. Максимальная длина имени пользователя ограничена 32 символами.
2. Password. В старых системах Linux зашифрованный пароль пользователя хранился в файле /etc/passwd. В большинстве современных систем это поле имеет значение x, и пароль пользователя сохраняется в файле /etc/shadow.
3. UID. Идентификатор пользователя — это номер, назначенный каждому пользователю. Он используется операционной системой для обращения к пользователю.
4. GID. Номер идентификатора группы пользователя, относящийся к основной группе пользователя. Когда пользователь создает файл, группа файла устанавливается на эту группу. Как правило, имя группы совпадает с именем пользователя. Пользователя вторичные группы перечислены в файле /etc/groups.
5. GECOS или полное имя пользователя. Это поле содержит список значений через запятую со следующей информацией:
    - Полное имя пользователя или название приложения.
    - Номер комнаты.
    - Рабочий номер телефона.
    - Домашний телефон.
    - Другая контактная информация.
6. Home directory. Абсолютный путь к домашнему каталогу пользователя. Он содержит файлы пользователя и конфигурации. По умолчанию домашние каталоги пользователей именуются по имени пользователя и создаются в каталоге /home.
7. Login shell. Абсолютный путь к оболочке входа пользователя. Это оболочка, которая запускается, когда пользователь входит в систему. В большинстве дистрибутивов Linux оболочкой входа по умолчанию является [Bash](https://andreyex.ru/tag/bash).

## Настройка ssh соединения
### Проброс локального порта на удаленный сервер
1. `ssh -L 8087:127.0.0.1:8080 <username>@<host> -p <port>`
2. Убедитесь, что на SSH-сервере включена переадресация TCP (по умолчанию так и должно быть). Проверьте запись в файле `/etc/ssh/sshd_config`:

```
AllowTcpForwarding yes
```
3. При переадресации портов на интерфейсы, отличные от _127.0.0.1_, в локальной системе необходимо включить `GatewayPorts` (в `/etc/ssh/ssh_config` или в командной строке):

```
GatewayPorts yes
```

## jenkins
### Установка
Получение ключей репозитория
```bash
sudo wget -O /usr/share/keyrings/jenkins-keyring.asc \
    https://pkg.jenkins.io/debian-stable/jenkins.io-2023.key
```
Добавить jenkins репозиторий
```bash
echo deb [signed-by=/usr/share/keyrings/jenkins-keyring.asc] \
    https://pkg.jenkins.io/debian-stable binary/ | sudo tee \
    /etc/apt/sources.list.d/jenkins.list > /dev/null
```
Установка jenkins
```
 sudo apt-get update
  sudo apt-get install fontconfig openjdk-17-jre
  sudo apt-get install jenkins
```
Добавление подчиненный uid дженкинсу. Если этого не сделать, будет ошибка на этапе сборки контейнера

```bash
echo jenkins:10000:65536 >> /etc/subgid
echo jenkins:10000:65536 >> /etc/subuid
```
### Получение ключа в гитлаб

### 